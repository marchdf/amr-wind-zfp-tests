# --- Simulation time control parameters ---
time.stop_time                           = 24990.0             # Max (simulated) time to evolve [s]
time.max_step                            = 117501
time.fixed_dt                            = 0.1                 # Fixed timestep size (in seconds). If negative, then time.cfl is used
time.checkpoint_start                    = 117500
incflo.physics                           = ABL Actuator        # List of physics models to include in simulation.
incflo.verbose                           = 0
io.check_file                            = chk
io.restart_file                          = /scratch/pmohan/two_turbine/precursor/chk117500
incflo.use_godunov                       = true
incflo.godunov_type                      = weno_z
incflo.diffusion_type                    = 2                   # Type of diffusion scheme used.  0 = explicit diffusion, 1 = Crank-Nicolson, 2 = fully implicit
turbulence.model                         = Smagorinsky
Smagorinsky_coeffs.Cs                    = 0.135
nodal_proj.mg_rtol                       = 1e-06
nodal_proj.mg_atol                       = 1e-12
mac_proj.mg_rtol                         = 1e-06
mac_proj.mg_atol                         = 1e-12
diffusion.mg_rtol                        = 1e-06
diffusion.mg_atol                        = 1e-12
temperature_diffusion.mg_rtol            = 1e-10
temperature_diffusion.mg_atol            = 1e-13
incflo.gravity                           = 0.0 0.0 -9.81       # Gravitational acceleration vector (x,y,z) [m/s^2]
incflo.density                           = 1.225               # Fluid density [kg/m^3]
transport.viscosity                      = 1e-05               # Fluid dynamic viscosity [kg/m-s]
transport.laminar_prandtl                = 0.7                 # Laminar prandtl number
transport.turbulent_prandtl              = 0.333               # Turbulent prandtl number

# --- Geometry and Mesh ---
geometry.prob_lo                         = 0.0 0.0 0.0
geometry.prob_hi                         = 3840.0 1600.0 960.0
amr.n_cell                               = 384 160 96          # Number of cells in x, y, and z directions
amr.max_level                            = 1
geometry.is_periodic                     = 0 1 0
xlo.type                                 = mass_inflow
xlo.density                              = 1.225
xlo.temperature                          = 0.0
xlo.tke                                  = 0.0
xhi.type                                 = pressure_outflow
zlo.type                                 = wall_model
zlo.temperature_type                     = fixed_gradient
zlo.temperature                          = 0.0
zhi.type                                 = slip_wall
zhi.temperature_type                     = fixed_gradient
zhi.temperature                          = 0.003

# --- ABL parameters ---
ICNS.source_terms                        = BoussinesqBuoyancy CoriolisForcing ActuatorForcing BodyForce ABLMeanBoussinesq
ABL.stats_output_frequency               = 2
ABL.stats_output_format                  = netcdf
ABL.tendency_forcing                     = false
ABL.bndry_io_mode                        = 1
ABL.bndry_file                           = /scratch/pmohan/two_turbine/precursor/bndry_files
ABL.bndry_planes                         = xlo
ABL.bndry_output_start_time              = 500.0
ABL.bndry_var_names                      = velocity temperature
ABL.bndry_output_format                  = native
incflo.velocity                          = 9.0 0.0 0.0
ABLForcing.abl_forcing_height            = 150.0
ABL.kappa                                = 0.41
ABL.normal_direction                     = 2
ABL.surface_roughness_z0                 = 0.1
ABL.reference_temperature                = 300.0
ABL.surface_temp_rate                    = 0.0
ABL.surface_temp_flux                    = 0.0                 # Surface temperature flux [K-m/s]
ABL.wall_shear_stress_type               = local
CoriolisForcing.latitude                 = 39.55
CoriolisForcing.rotational_time_period   = 86400.0
CoriolisForcing.north_vector             = 0.0 1.0 0.0
CoriolisForcing.east_vector              = 1.0 0.0 0.0
BoussinesqBuoyancy.reference_temperature = 300.0
BodyForce.magnitude                      = 0.00042719372748382923 0.0009968833451974384 0.0
ABL.temperature_heights                  = 0.0 960
ABL.temperature_values                   = 290 292.8
ABLMeanBoussinesq.read_temperature_profile = false
ABL.perturb_velocity                     = true
ABL.perturb_ref_height                   = 50.0
ABL.Uperiods                             = 4.0
ABL.Vperiods                             = 4.0
ABL.deltaU                               = 0.25
ABL.deltaV                               = 0.25
ABL.perturb_temperature                  = false
ABL.theta_amplitude                      = 0.8
ABL.cutoff_height                        = 50.0
time.plot_interval                       = 1
io.plot_file                             = plt
io.nfiles                                = 32
io.KE_int                                = -1
Actuator.type                            = JoukowskyDisk
Actuator.JoukowskyDisk.epsilon           = 5.0
Actuator.JoukowskyDisk.num_blades        = 3                   # Number of wind turbine blades
Actuator.JoukowskyDisk.vortex_core_size  = 24.0
Actuator.JoukowskyDisk.use_tip_correction = true                # Turn on tip correction
Actuator.JoukowskyDisk.use_root_correction = true                # Turn on root correction

#---- actuator defs ----
Actuator.labels                          = T0 T1
Actuator.T0.type                         = JoukowskyDisk
Actuator.T0.base_position                = 480.0 800.0 0.0
Actuator.T0.rotor_diameter               = 240.0
Actuator.T0.hub_height                   = 150.0
Actuator.T0.fllc                         = false
Actuator.T0.yaw                          = 270.0
Actuator.T0.output_frequency             = 10
Actuator.T0.diameters_to_sample          = 1.0
Actuator.T0.thrust_coeff                 = 8.1672e-01 7.9044e-01 7.8393e-01 7.8624e-01 7.8824e-01 7.8942e-01 7.8902e-01 7.8740e-01 7.8503e-01 7.8237e-01 7.7955e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.6922e-01 7.4270e-01 5.5949e-01 4.6163e-01 3.8786e-01 3.2901e-01 2.8093e-01 2.4114e-01 2.0795e-01 1.8010e-01 1.5663e-01 1.3679e-01 1.1995e-01 1.0562e-01 9.3384e-02 8.2908e-02 7.3910e-02 6.6159e-02 5.9463e-02 5.3662e-02 4.8622e-02 4.4230e-02
Actuator.T0.wind_speed                   = 3.0000e+00 3.5495e+00 4.0679e+00 4.5539e+00 5.0064e+00 5.4244e+00 5.8069e+00 6.1530e+00 6.4619e+00 6.7330e+00 6.9655e+00 7.1589e+00 7.3128e+00 7.4269e+00 7.5009e+00 7.5345e+00 7.5412e+00 7.5883e+00 7.6757e+00 7.8031e+00 7.9702e+00 8.1767e+00 8.4221e+00 8.7059e+00 9.0273e+00 9.3856e+00 9.7800e+00 1.0210e+01 1.0659e+01 1.0673e+01 1.1170e+01 1.1699e+01 1.2259e+01 1.2848e+01 1.3465e+01 1.4109e+01 1.4778e+01 1.5471e+01 1.6185e+01 1.6921e+01 1.7674e+01 1.8445e+01 1.9231e+01 2.0030e+01 2.0841e+01 2.1661e+01 2.2489e+01 2.3323e+01 2.4160e+01 2.5000e+01
Actuator.T0.rpm                          = 5.0000e+00 5.0000e+00 5.0000e+00 5.0000e+00 5.0000e+00 5.0000e+00 5.0000e+00 5.0000e+00 5.0000e+00 5.0000e+00 5.0000e+00 5.0861e+00 5.1954e+00 5.2765e+00 5.3290e+00 5.3529e+00 5.3577e+00 5.3912e+00 5.4532e+00 5.5437e+00 5.6625e+00 5.8092e+00 5.9836e+00 6.1851e+00 6.4135e+00 6.6681e+00 6.9483e+00 7.2535e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00
Actuator.T0.num_points_r                 = 40
Actuator.T0.num_points_t                 = 5
Actuator.T0.num_blades                   = 3
Actuator.T0.use_tip_correction           = true
Actuator.T0.use_root_correction          = true
Actuator.T1.type                         = JoukowskyDisk
Actuator.T1.base_position                = 2160.0 800.0 0.0
Actuator.T1.rotor_diameter               = 240.0
Actuator.T1.hub_height                   = 150.0
Actuator.T1.fllc                         = false
Actuator.T1.yaw                          = 270.0
Actuator.T1.output_frequency             = 10
Actuator.T1.diameters_to_sample          = 1.0
Actuator.T1.thrust_coeff                 = 8.1672e-01 7.9044e-01 7.8393e-01 7.8624e-01 7.8824e-01 7.8942e-01 7.8902e-01 7.8740e-01 7.8503e-01 7.8237e-01 7.7955e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.7583e-01 7.6922e-01 7.4270e-01 5.5949e-01 4.6163e-01 3.8786e-01 3.2901e-01 2.8093e-01 2.4114e-01 2.0795e-01 1.8010e-01 1.5663e-01 1.3679e-01 1.1995e-01 1.0562e-01 9.3384e-02 8.2908e-02 7.3910e-02 6.6159e-02 5.9463e-02 5.3662e-02 4.8622e-02 4.4230e-02
Actuator.T1.wind_speed                   = 3.0000e+00 3.5495e+00 4.0679e+00 4.5539e+00 5.0064e+00 5.4244e+00 5.8069e+00 6.1530e+00 6.4619e+00 6.7330e+00 6.9655e+00 7.1589e+00 7.3128e+00 7.4269e+00 7.5009e+00 7.5345e+00 7.5412e+00 7.5883e+00 7.6757e+00 7.8031e+00 7.9702e+00 8.1767e+00 8.4221e+00 8.7059e+00 9.0273e+00 9.3856e+00 9.7800e+00 1.0210e+01 1.0659e+01 1.0673e+01 1.1170e+01 1.1699e+01 1.2259e+01 1.2848e+01 1.3465e+01 1.4109e+01 1.4778e+01 1.5471e+01 1.6185e+01 1.6921e+01 1.7674e+01 1.8445e+01 1.9231e+01 2.0030e+01 2.0841e+01 2.1661e+01 2.2489e+01 2.3323e+01 2.4160e+01 2.5000e+01
Actuator.T1.rpm                          = 5.0000e+00 5.0000e+00 5.0000e+00 5.0000e+00 5.0000e+00 5.0000e+00 5.0000e+00 5.0000e+00 5.0000e+00 5.0000e+00 5.0000e+00 5.0861e+00 5.1954e+00 5.2765e+00 5.3290e+00 5.3529e+00 5.3577e+00 5.3912e+00 5.4532e+00 5.5437e+00 5.6625e+00 5.8092e+00 5.9836e+00 6.1851e+00 6.4135e+00 6.6681e+00 6.9483e+00 7.2535e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00 7.4992e+00
Actuator.T1.num_points_r                 = 40
Actuator.T1.num_points_t                 = 5
Actuator.T1.num_blades                   = 3
Actuator.T1.use_tip_correction           = true
Actuator.T1.use_root_correction          = true

#---- tagging defs ----
tagging.labels                           = T0_level_0_zone T1_level_0_zone
tagging.T0_level_0_zone.type             = GeometryRefinement  
tagging.T0_level_0_zone.shapes           = T0_level_0_zone     
tagging.T0_level_0_zone.level            = 0                   
tagging.T0_level_0_zone.T0_level_0_zone.type = box                 
tagging.T0_level_0_zone.T0_level_0_zone.origin = 240.0 440.0 0.0     
tagging.T0_level_0_zone.T0_level_0_zone.xaxis = 1680.0 0.0 0.0      
tagging.T0_level_0_zone.T0_level_0_zone.yaxis = -0.0 720.0 -0.0     
tagging.T0_level_0_zone.T0_level_0_zone.zaxis = 0.0 0.0 510.0       
tagging.T1_level_0_zone.type             = GeometryRefinement  
tagging.T1_level_0_zone.shapes           = T1_level_0_zone     
tagging.T1_level_0_zone.level            = 0                   
tagging.T1_level_0_zone.T1_level_0_zone.type = box                 
tagging.T1_level_0_zone.T1_level_0_zone.origin = 1920.0 440.0 0.0    
tagging.T1_level_0_zone.T1_level_0_zone.xaxis = 1680.0 0.0 0.0      
tagging.T1_level_0_zone.T1_level_0_zone.yaxis = -0.0 720.0 -0.0     
tagging.T1_level_0_zone.T1_level_0_zone.zaxis = 0.0 0.0 510.0       


#---- postprocessing defs ----
incflo.post_processing                   = XY_ XZ_ YZinflow_ YZwake_
XY_.type                                 = Sampling
XY_.output_frequency                     = 25
XY_.fields                               = velocity temperature
XZ_.type                                 = Sampling
XZ_.output_frequency                     = 25
XZ_.fields                               = velocity temperature
YZinflow_.type                           = Sampling
YZinflow_.output_frequency               = 25
YZinflow_.fields                         = velocity temperature
YZwake_.type                             = Sampling
YZwake_.output_frequency                 = 25
YZwake_.fields                           = velocity temperature

#---- sample defs ----
XY_.labels                               = T0_XY T1_XY
XZ_.labels                               = T0_XZ T1_XZ
YZinflow_.labels                         = T0_YZ_inflow1 T1_YZ_inflow1
YZwake_.labels                           = T0_YZ_wake1 T1_YZ_wake1
XY_.T0_XY.type                           = PlaneSampler
XY_.T0_XY.num_points                     = 361 161
XY_.T0_XY.origin                         = 0.0 320.0 150.0
XY_.T0_XY.axis1                          = 2160.0 0.0 0.0
XY_.T0_XY.axis2                          = -0.0 960.0 -0.0
XY_.T0_XY.offset_vector                  = 0.0 0.0 1.0
XY_.T0_XY.offsets                        = 0.0 360.0
XY_.T1_XY.type                           = PlaneSampler
XY_.T1_XY.num_points                     = 361 161
XY_.T1_XY.origin                         = 1680.0 320.0 150.0
XY_.T1_XY.axis1                          = 2160.0 0.0 0.0
XY_.T1_XY.axis2                          = -0.0 960.0 -0.0
XY_.T1_XY.offset_vector                  = 0.0 0.0 1.0
XY_.T1_XY.offsets                        = 0.0 360.0
XZ_.T0_XZ.type                           = PlaneSampler
XZ_.T0_XZ.num_points                     = 361 86
XZ_.T0_XZ.origin                         = 0.0 800.0 0.0
XZ_.T0_XZ.axis1                          = 2160.0 0.0 0.0
XZ_.T0_XZ.axis2                          = 0.0 0.0 510.0
XZ_.T0_XZ.offset_vector                  = -0.0 1.0 -0.0
XZ_.T0_XZ.offsets                        = 0.0 0.0
XZ_.T1_XZ.type                           = PlaneSampler
XZ_.T1_XZ.num_points                     = 361 86
XZ_.T1_XZ.origin                         = 1680.0 800.0 0.0
XZ_.T1_XZ.axis1                          = 2160.0 0.0 0.0
XZ_.T1_XZ.axis2                          = 0.0 0.0 510.0
XZ_.T1_XZ.offset_vector                  = -0.0 1.0 -0.0
XZ_.T1_XZ.offsets                        = 0.0 0.0
YZinflow_.T0_YZ_inflow1.type             = PlaneSampler
YZinflow_.T0_YZ_inflow1.num_points       = 161 86
YZinflow_.T0_YZ_inflow1.origin           = 300.0 320.0 0.0
YZinflow_.T0_YZ_inflow1.axis1            = -0.0 960.0 -0.0
YZinflow_.T0_YZ_inflow1.axis2            = 0.0 0.0 510.0
YZinflow_.T0_YZ_inflow1.offset_vector    = 1.0 0.0 0.0
YZinflow_.T0_YZ_inflow1.offsets          = 0.0 120.0
YZinflow_.T1_YZ_inflow1.type             = PlaneSampler
YZinflow_.T1_YZ_inflow1.num_points       = 161 86
YZinflow_.T1_YZ_inflow1.origin           = 1980.0 320.0 0.0
YZinflow_.T1_YZ_inflow1.axis1            = -0.0 960.0 -0.0
YZinflow_.T1_YZ_inflow1.axis2            = 0.0 0.0 510.0
YZinflow_.T1_YZ_inflow1.offset_vector    = 1.0 0.0 0.0
YZinflow_.T1_YZ_inflow1.offsets          = 0.0 120.0
YZwake_.T0_YZ_wake1.type                 = PlaneSampler
YZwake_.T0_YZ_wake1.num_points           = 161 86
YZwake_.T0_YZ_wake1.origin               = 456.0 320.0 0.0
YZwake_.T0_YZ_wake1.axis1                = -0.0 960.0 -0.0
YZwake_.T0_YZ_wake1.axis2                = 0.0 0.0 510.0
YZwake_.T0_YZ_wake1.offset_vector        = 1.0 0.0 0.0
YZwake_.T0_YZ_wake1.offsets              = 0.0 244.8 489.6 734.4000000000001 979.2 1224.0
YZwake_.T1_YZ_wake1.type                 = PlaneSampler
YZwake_.T1_YZ_wake1.num_points           = 161 86
YZwake_.T1_YZ_wake1.origin               = 2136.0 320.0 0.0
YZwake_.T1_YZ_wake1.axis1                = -0.0 960.0 -0.0
YZwake_.T1_YZ_wake1.axis2                = 0.0 0.0 510.0
YZwake_.T1_YZ_wake1.offset_vector        = 1.0 0.0 0.0
YZwake_.T1_YZ_wake1.offsets              = 0.0 244.8 489.6 734.4000000000001 979.2 1224.0

#---- extra params ----
time.checkpoint_time_interval            = 500
ABL.bndry_write_frequency                = 1
transport.reference_temperature          = 300
CoriolisForcing.turn_off_vertical_force  = True
ABL.initial_wind_profile                 = false
#== END AMR-WIND INPUT ==
